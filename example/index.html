<!DOCTYPE html>
<html>
  <head>
    <title>Test</title>
    
	<script type="text/javascript" src="jquery-1.4.2.js"></script>

    <script type="text/javascript">
    	
			function log(msg){
				var el = $('#log');
				var content = el.val() + msg;
				el.val(content);
			}

            var ws;
		
		$(document).ready(function(){
			
            $("#connect").click(function(e){
                e.preventDefault();
				var uri = $("#uri").val();
                ws = new WebSocket(uri);

                ws.onopen = function() {
					$('#connect').attr("disabled","disabled");
					$('#disconnect').attr("disabled","");
                }

                ws.onmessage = function(e) {
                    console.log(e);
                    log( e.data + "\n");
                }

                ws.onclose = function() {
                    ws = null;
                }
            });

            $("#disconnect").click(function(e) {
                e.preventDefault();
                if (ws) {
                    ws.close();
                }
				$('#connect').attr("disabled","");
				$('#disconnect').attr("disabled","disabled");
            });

            $("#send").click(function(e) {
                e.preventDefault();
                var msg = $('#msg').val();
                ws.send(msg);
            });

		})
    </script>
  </head>
  <body> 
    <input type="text" id="uri" value="ws://localhost:10125" style="width:200px;"> 
	<input type="button" id="connect" value="Connect">
	<input type="button" id="disconnect" value="Disconnect" disabled="disabled">
    <form id="sendForm">
    	<input type="text" id="msg" value="" style="width:200px;">
		<input type="submit" id="send" value="Send">
	</form><br>
    <textarea id="log" rows="30" cols="100" style="font-family:monospace; color:red;"></textarea>
  </body>
</html>
